% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/sql_model_matrix.R
\name{sql_model_matrix}
\alias{sql_model_matrix}
\title{Build SQL expressions equivalent to model.matrix()}
\usage{
sql_model_matrix(formula, conn, table, expand = c("all", "interactions"))
}
\arguments{
\item{formula}{A formula (or Formula) object}

\item{conn}{Database connection}

\item{table}{Table name or FROM clause}

\item{expand}{Character: "all" expands factors and interactions, 
"interactions" only expands interaction terms (factors in main effects 
kept as-is for grouping)}
}
\value{
List with:
  - `select_exprs`: character vector of SQL expressions
  - `col_names`: corresponding column names
  - `factor_levels`: list of factor levels by variable (for reference)
}
\description{
Expands formula terms into SQL SELECT expressions, handling factor one-hot
encoding and interaction terms.
}
\examples{
library(DBI)
library(duckdb)
con = dbConnect(duckdb())
dbWriteTable(con, "test", data.frame(x1 = 1:3, x2 = c("a", "b", "c")))
sql_model_matrix(~ x1 + x2, con, "test")
sql_model_matrix(~ x1:x2, con, "test")
dbDisconnect(con)
}
